{"componentChunkName":"component---src-templates-blog-template-js","path":"/react-strategy-pattern/","result":{"data":{"cur":{"id":"155c7802-1be1-5ccb-9e6e-7a03fd0cf67b","html":"<h2 id=\"들어가며\" style=\"position:relative;\"><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\" aria-label=\"들어가며 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>들어가며</h2>\n<p>최근 소속된 개발자 커뮤니티의 네트워킹 행사에서 <strong>반복되는 분기처리에 전략패턴 도입하기</strong>라는 제목으로 발표를 했다. 주제를 정해 발표 자료를 준비하고 피드백을 요청해 다듬어나간 경험만으로도 즐겁고 알찬 경험이었지만, 글로도 남겨보면 더 오래오래 남을 것 같아 블로그에도 정리해본다.</p>\n<h2 id=\"전략패턴에-관심을-가지게-된-계기\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EB%9E%B5%ED%8C%A8%ED%84%B4%EC%97%90-%EA%B4%80%EC%8B%AC%EC%9D%84-%EA%B0%80%EC%A7%80%EA%B2%8C-%EB%90%9C-%EA%B3%84%EA%B8%B0\" aria-label=\"전략패턴에 관심을 가지게 된 계기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전략패턴에 관심을 가지게 된 계기</h2>\n<p>인력 관리 솔루션의 출퇴근 기능을 담당하며 다양한 근태 타입과 사용자 권한에 따른 따른 분기처리가 필요했다.</p>\n<p>서비스 특성상 스케줄 등 다른 기능을 개발하는 팀원이 내 코드를 참고할 일도 있을 것이고, 추후 요구사항이 변동될 가능성도 있어(세상엔 내 생각보다 다양한 근태 유형이 존재했다..) 가독성과 유지보수에 대한 고민이 많았다.</p>\n<p>머릿속을 스쳐지나간 절망편 시나리오들···</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbUlEQVQoz1WRSW7CQBBFreCpGTwEGRmEAEdBWRAbEwk8MNhgwLKzyT53yCrrLLLOAXKCXPNH1cgMi6/6Xd39WvVbEAQB16ozBtM0YRgGr9de1/VzraSqKhhjEEWxYpxAv1/PCCYMZruLosix2WywXq9xPB6RJAnyPMfhcEBZltjv98iyDGmawnVdjMdjDj0DDb2Fv+8XZHMb3b6D17JAURTYbreI45gDqXqexwGz2Qy+7/N1FEWYTj0+2RloWRZGDxP0+iO02/cYjkYYDAZwHAe2bXPf6XTQaDTQarXQbDZvpGn67ciKooAxBUxV+AG6WKlany5qXJTdqWqQJAmSVIOiSBfgcDjEarVCGIY8H8pmuVxykac9ynO32/HRKQqKYZMkkJmBj/cn/Hz6FyCNRQdJBJ3P57xSRuRJi8WCP0DZBUGAOAzhLiI0rT7SWQ9v6eMFWH29LMtcFMF1jzz1qn4l2pckEXeiippc58B/HpbX/Nq2frwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img_1\"\n        title=\"img_1\"\n        src=\"/static/6be2bc66133697df9088069fb059fc6f/37523/img_1.png\"\n        srcset=\"/static/6be2bc66133697df9088069fb059fc6f/e9ff0/img_1.png 180w,\n/static/6be2bc66133697df9088069fb059fc6f/f21e7/img_1.png 360w,\n/static/6be2bc66133697df9088069fb059fc6f/37523/img_1.png 720w,\n/static/6be2bc66133697df9088069fb059fc6f/302a4/img_1.png 1080w,\n/static/6be2bc66133697df9088069fb059fc6f/07a9c/img_1.png 1440w,\n/static/6be2bc66133697df9088069fb059fc6f/e3261/img_1.png 2324w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABjUlEQVQoz2VRW3KiUBS8gMGLID6qgiFkxsgF5DGWjlUq4cexfI2SZWQLWUA2MEuZLXbqHBNTNfPRRfd53dMHIYTABQaEMKHpOly3jU6ni273C71eD67rot2mXIdj9CVtmiauczTtQmaFj7fXLWSzifLpCafTCZvNBuv1Gvv9njXx7XaL8/mM3W7Hsel0yg/9N3A+7uPtJUPbsbFaldxAg6qqug6czWbI8xxFkSOOY6RpijAMedsvpx/EaEhIx4Ou67Btm60QHMfhDajJsixIKWEYJiyrdc1RXNM07hVUoJRCnmWI1AhJkiAjHkW8zWQy4W2oJktT2HYLA68F/87D40jh8fs3BPf3CIIAnudB9Pt9tnc4HPhmdJ+6rvlWZJVix+MRdX3G7vAbgX+Lv38qPP8aYzhKkaVjFEkMFYa4830IslcUBcqy5BstFgssl0vWxOfzOfOqXOHHokLv1sPP8QPSRCFUEaJYsbPhcIjBYEA/5eKdYBgG41P/C8pRvRA6bswmLEtCfkJKNBoNvANgwtfMzp1fmwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img_2\"\n        title=\"img_2\"\n        src=\"/static/9b49ab90c5c18c56ebe3e35da91b5ff8/37523/img_2.png\"\n        srcset=\"/static/9b49ab90c5c18c56ebe3e35da91b5ff8/e9ff0/img_2.png 180w,\n/static/9b49ab90c5c18c56ebe3e35da91b5ff8/f21e7/img_2.png 360w,\n/static/9b49ab90c5c18c56ebe3e35da91b5ff8/37523/img_2.png 720w,\n/static/9b49ab90c5c18c56ebe3e35da91b5ff8/302a4/img_2.png 1080w,\n/static/9b49ab90c5c18c56ebe3e35da91b5ff8/07a9c/img_2.png 1440w,\n/static/9b49ab90c5c18c56ebe3e35da91b5ff8/9d53e/img_2.png 2542w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>고민을 이어나가던 도중 개발 커뮤니티에서 보았던 <strong>디자인 패턴은 내 코드를 공용어로 만든다</strong>는 문장이 떠올랐고, 이를 인사이트 삼아 디자인 패턴을 적용해보자는 생각이 들었다.</p>\n<h2 id=\"디자인-패턴\" style=\"position:relative;\"><a href=\"#%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4\" aria-label=\"디자인 패턴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>디자인 패턴</h2>\n<p>Design Patterns: Elements of Reusable Object-Oriented Software의 분류에 따르면, 디자인 패턴은 크게 세 가지로 분류된다.</p>\n<h3 id=\"생성-패턴-creational-pattern\" style=\"position:relative;\"><a href=\"#%EC%83%9D%EC%84%B1-%ED%8C%A8%ED%84%B4-creational-pattern\" aria-label=\"생성 패턴 creational pattern permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>생성 패턴 (Creational Pattern)</h3>\n<ul>\n<li>객체 생성 과정을 추상화하는 패턴</li>\n<li>싱글톤, 프로토타입, 팩토리 메서드 패턴 등\n<br/></li>\n</ul>\n<h3 id=\"구조-패턴-structural-pattern\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%EC%A1%B0-%ED%8C%A8%ED%84%B4-structural-pattern\" aria-label=\"구조 패턴 structural pattern permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구조 패턴 (Structural Pattern)</h3>\n<ul>\n<li>클래스, 객체를 조합해 더 큰 구조를 만드는 패턴</li>\n<li>데코레이터, 프록시, 어댑터, 브릿지 패턴 등\n<br/></li>\n</ul>\n<h3 id=\"행동-패턴-behavioral-pattern\" style=\"position:relative;\"><a href=\"#%ED%96%89%EB%8F%99-%ED%8C%A8%ED%84%B4-behavioral-pattern\" aria-label=\"행동 패턴 behavioral pattern permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>행동 패턴 (Behavioral Pattern)</h3>\n<ul>\n<li>객체, 클래스 간 상호작용과 책임 분배를 다루는 패턴</li>\n<li>전략, 옵저버, 커맨드, 이터레이터, 메멘토 패턴 등</li>\n</ul>\n<p>아무래도 ‘생성’ 혹은 더 큰 ‘구조’를 만드는 데 집중하는 다른 패턴보다 행동 패턴을 주목했다. 행동 패턴은 아래 방법을 통해 객체/클래스간의 상호작용을 효과적으로 처리하는 패턴이기에 분기처리에 적합할 거라 판단했기 때문.</p>\n<ol>\n<li>객체, 클래스 간의 <strong>의존성을 최소화</strong>해 느슨한 결합을 만든다.</li>\n<li>객체, 클래스의 행동을 <strong>캡슐화</strong>해 재사용성을 높인다.</li>\n</ol>\n<p>그리고 이 중에서도 최종적으로 전략 패턴을 선택하게 되었다.</p>\n<h2 id=\"전략-패턴\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EB%9E%B5-%ED%8C%A8%ED%84%B4\" aria-label=\"전략 패턴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전략 패턴</h2>\n<p>전략 패턴은 <strong>전략을 캡슐화해 런타임에서 동적으로 선택하는 패턴</strong>으로, 다음과 같은 구성요소로 이루어져 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAACq0lEQVQ4y52Ve3PSQBTF8yLvkDebF49CICWAYEvrC622VqW1lNbRdkb9/h/jOFmx1FqQ9o+d3NzdPTl3c+e3DMMwuG8IJQklUQYniGBYDgzD0rgkKTTPsCxW7P03KUoyao0mkloN/cETHB4d4cPHTzQuco1mC5KiPkBQVpHUmwjiKhqtNnqDIQajHTRaHZpLGi3Iqra5oCDKsH2CMKmhEkRwPALHJyBhTIdLQpQkeXNBTiihQggGgz7ybhf7+3sYj8fIsg7Gu7vIsgwsx28uyAsiCAmQdTrodDrodrtI05QKE0IWVUgPcMgLMEwHtutDL9tophnaWQ7T8WBYDhS9DF4QNhe8O1zXQxTFi3cW7OqWWS9YuFA0Hapehmm7kFUdvFD6n4HVk7pp49nLCd4dHuHNwVs8fzWhJT9aUNEN7IzHOD5+j5PpFOO9fer20YKaYaG9nePp7hgvJ6+RD4bQDPMxgr8PXVYN2JUIuulAt1x4QQJZM/5as7HDklBCdauNVtrGaDTCaDhEmraR1FsQV/fgHcFFO/A8D8uyUbYcSIpOCSNICkRZg2HasGyHrrm9Z61DZTVJboaqrqFNgatKGMMnIYIoQX0rpVAoYo+ECxcshUSRK+bqzZSSp4hJlNzGGUNLm36eYXpyivnFJc4vLjGbX+D7j5+YHBzefH3/xQSz8zlOz2aYX37B2ewc366u8fXqGrZXWQoqmgGHxDd/03R8uCSCH0SoxHVwHA+W4+AGCXTLgWF7MGwXjh/AK9aECVTDWgoW/NtqpcjzHL3+ANVafXmeWpnCooi9Soher49su4tunkOS5QVMeEiqvhQs7gg/iBHGVcS1Bj0XUdEolQvHHGUfS51HSZWCN67WaZNLikbpUzzX9iHHcbRMll5QzL3NXFCHXaz7k/8FFGL2iDpWMfIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"strategy-pattern-diagram\"\n        title=\"strategy-pattern-diagram\"\n        src=\"/static/1152f65961f825cca5ff552e6c5670a3/37523/img_3.png\"\n        srcset=\"/static/1152f65961f825cca5ff552e6c5670a3/e9ff0/img_3.png 180w,\n/static/1152f65961f825cca5ff552e6c5670a3/f21e7/img_3.png 360w,\n/static/1152f65961f825cca5ff552e6c5670a3/37523/img_3.png 720w,\n/static/1152f65961f825cca5ff552e6c5670a3/302a4/img_3.png 1080w,\n/static/1152f65961f825cca5ff552e6c5670a3/99661/img_3.png 1098w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p><code class=\"language-text\">Context</code> : 전략을 사용하는 클래스</p>\n</li>\n<li>\n<p><code class=\"language-text\">Strategy</code> : 모든 전략에 대한 공통 인터페이스</p>\n</li>\n<li>\n<p><code class=\"language-text\">ConcreteStrategy</code> : 전략 인터페이스를 구현하는 구체적인 전략 클래스</p>\n</li>\n</ul>\n<p>위의 UML Class diagram과 맞는 예제 코드를 아래에 간단하게 작성해봤다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//Strategy</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Strategy</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//ConcreteStrategy</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ConcreteStrategyA</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Strategy</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Let's run strategy A!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Strategy A 고유의 알고리즘 구현</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ConcreteStrategyB</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Strategy</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Let's run strategy B!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Strategy B 고유의 알고리즘 구현</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Context</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Context</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> strategy<span class=\"token operator\">:</span> Strategy<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>strategy<span class=\"token operator\">:</span> Strategy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>strategy <span class=\"token operator\">=</span> strategy<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">setStrategy</span><span class=\"token punctuation\">(</span>strategy<span class=\"token operator\">:</span> Strategy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>strategy <span class=\"token operator\">=</span> strategy<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">executeStrategy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>strategy<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Usage</span>\n<span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Context</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcreteStrategyA</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncontext<span class=\"token punctuation\">.</span><span class=\"token function\">executeStrategy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Let's run strategy A!\" 출력</span>\n\ncontext<span class=\"token punctuation\">.</span><span class=\"token function\">setStrategy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcreteStrategyB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncontext<span class=\"token punctuation\">.</span><span class=\"token function\">executeStrategy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Let's run strategy B!\" 출력</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">ConcreteStrategyA</code>와 <code class=\"language-text\">ConcreteStrategyB</code>는 공통 인터페이스를 따라 <code class=\"language-text\">execute()</code>를 구현하지만, 그 세부 구현은 같지 않다. (console에 출력하는 메세지가 다름을 알 수 있다.)</li>\n<li>context의 <code class=\"language-text\">executeStrategy</code>에선 구체적 전략의 <code class=\"language-text\">execute()</code>의 로직을 알지 못한다.</li>\n</ul>\n<h3 id=\"주요-특징\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%ED%8A%B9%EC%A7%95\" aria-label=\"주요 특징 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 특징</h3>\n<p>이 패턴의 핵심은 <strong><code class=\"language-text\">Context</code>는 구체적인 전략 <code class=\"language-text\">ConcreteStrategy</code>를 직접 참조하지 않고, <code class=\"language-text\">Strategy</code> 인터페이스를 통해 작업을 수행한다</strong>. 이로 인해 다음과 같은 이점을 가져온다.</p>\n<ol>\n<li>\n<p><strong>결합도 감소</strong> : <code class=\"language-text\">Context</code> 는 구체적인 전략에 의존하지 않고, 추상화된 전략 인터페이스에 의존한다. <strong>구체화 대신 추상화에 의존한다</strong>는 사실은 곧 SOLID 원칙의 <strong>의존성 역전 원칙</strong>(DIP: Dependency Inversion Principle)과 연결된다. 전략 패턴은 의존성 역전 원칙을 따르며 <code class=\"language-text\">Context</code> 와 <code class=\"language-text\">ConcreteStrategy</code> 사이의 결합도를 낮춘다.</p>\n</li>\n<li>\n<p><strong>유연성 증가</strong> : 각각의 전략은 별도의 클래스로 구현되어 있어, 전략의 내부 로직은 Context와 분리된다. 따라서 각 전략을 독립적으로 개발하고 테스트할 수 있으며, 새로운 전략을 추가하거나 기존 전략을 변경할 때 전략을 사용하는 <code class=\"language-text\">Context</code>의 코드를 수정할 필요가 없다.</p>\n</li>\n</ol>\n<h2 id=\"도입-과정\" style=\"position:relative;\"><a href=\"#%EB%8F%84%EC%9E%85-%EA%B3%BC%EC%A0%95\" aria-label=\"도입 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>도입 과정</h2>\n<blockquote>\n<p>간략하게 재구성한 예제 코드를 기반으로 작성했으며, 일부 type 정의 등이 생략되었을 수 있음</p>\n</blockquote>\n<h3 id=\"무엇을-추상화할까\" style=\"position:relative;\"><a href=\"#%EB%AC%B4%EC%97%87%EC%9D%84-%EC%B6%94%EC%83%81%ED%99%94%ED%95%A0%EA%B9%8C\" aria-label=\"무엇을 추상화할까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>무엇을 추상화할까?</h3>\n<p>가장 먼저 어디까지를 전략으로 삼을지 고민하는 과정이 필요했다.</p>\n<p>나의 경우 근태 기록 편집 Modal의 부분 부분에서 분기처리가 반복되었는데, 기획서를 보며 정확히 어느 부분에 분기처리가 반복되는지 파악하고, 추후 변경될 여지가 있는지도 기획자와 면밀하게 소통하며 전략을 정해나갔다. 그리고 최종적으로 아래 요소들을 전략으로 삼았다.</p>\n<ul>\n<li>근태 타입 Icon path : <code class=\"language-text\">string</code></li>\n<li>근태 타입 PopOver : <code class=\"language-text\">UI component</code></li>\n<li>근태 상세 기록 List : <code class=\"language-text\">UI Component</code></li>\n<li>유효성 검증 로직 : <code class=\"language-text\">function</code></li>\n</ul>\n<p>전략의 범위를 결정하는 과정에서 <strong>조건이 2가지로 적고 자주 변경되지 않는</strong> 사용자 권한에 따른 분기처리는 전략 패턴을 적용하는 건 오버 엔지니어링이라 판단해 추상화 대상에서 제외했다.</p>\n<h3 id=\"strategy-concretestrategy-정의\" style=\"position:relative;\"><a href=\"#strategy-concretestrategy-%EC%A0%95%EC%9D%98\" aria-label=\"strategy concretestrategy 정의 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Strategy, ConcreteStrategy 정의</h3>\n<p>앞 단계에서 결정한 4개의 전략들로 구성된 <strong>Strategy</strong> interface인 <code class=\"language-text\">AttendanceStrategy</code>를 정의한다.\n앞으로의 <strong>ConcreteStrategy</strong>는 모두 이 구조에 따라 일관성있게 구현된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">AttendanceStrategy</span> <span class=\"token punctuation\">{</span>\n  iconPath<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  AttendanceTypePopOver<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token punctuation\">;</span>\n  AttendanceDetails<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">validateRecord</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>data<span class=\"token operator\">:</span> RecordDataType<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>이제 <strong>ConcreteStrategy</strong>를 구현할 차례. 각각의 근태 유형에 따른 전략을 담은 전략 객체 <code class=\"language-text\">attendanceStrategies</code>를 구현한다.\n구조는 앞서 정의한 <strong>Strategy</strong> <code class=\"language-text\">AttendanceStrategy</code>를 따른다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> attendanceStrategies<span class=\"token operator\">:</span> Record<span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> AttendanceStrategy<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">LATE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    iconPath<span class=\"token operator\">:</span> <span class=\"token string\">'/icons/late.svg'</span><span class=\"token punctuation\">,</span>\n    AttendanceTypePopOver<span class=\"token operator\">:</span> LatePopOver<span class=\"token punctuation\">,</span>\n    AttendanceDetails<span class=\"token operator\">:</span> LateDetails<span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">validateRecord</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>data<span class=\"token operator\">:</span> RecordDataType<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">EARLY_LEAVE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    iconPath<span class=\"token operator\">:</span> <span class=\"token string\">'/icons/early-leave.svg'</span><span class=\"token punctuation\">,</span>\n    AttendanceTypePopOver<span class=\"token operator\">:</span> EarlyLeavePopOver<span class=\"token punctuation\">,</span>\n    AttendanceDetails<span class=\"token operator\">:</span> EarlyLeaveDetails<span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">validateRecord</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>data<span class=\"token operator\">:</span> RecordDataType<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// 다른 전략들 ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>추후 다른 전략을 추가해야 한다면 다른 전략과 동일하게 <code class=\"language-text\">AttendanceStrategy</code>의 구조를 따르는 전략을 객체의 하위에 생성하면 된다.\n새로운 전략을 추가할 때 기존 코드에 영향이 가는 부분은 없다. 기존 전략을 수정할 때도 해당 전략의 코드만 수정하면 되므로 다른 전략 코드에서의 side effect를 걱정할 필요가 없다.</p>\n<h3 id=\"정의한-전략-사용하기\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EC%9D%98%ED%95%9C-%EC%A0%84%EB%9E%B5-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"정의한 전략 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정의한 전략 사용하기</h3>\n<p>이제 <strong>Context</strong> 역할을 하는 코드를 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">AttendanceEditModal</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    iconPath<span class=\"token punctuation\">,</span>\n    AttendanceTypePopOver<span class=\"token punctuation\">,</span>\n    AttendanceDetails<span class=\"token punctuation\">,</span>\n    validateRecord<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> attendanceStrategies<span class=\"token punctuation\">[</span>type<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleSave</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>data<span class=\"token operator\">:</span> RecordDataType<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    <span class=\"token function\">validateRecord</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token function\">saveRecord</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">handleError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Modal<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Modal<span class=\"token punctuation\">.</span>Header<span class=\"token operator\">></span>근태 기록 편집<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Modal<span class=\"token punctuation\">.</span>Header<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Modal<span class=\"token punctuation\">.</span>Body<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setShowPopOver</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> onMouseLeave<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setShowPopOver</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>iconPath<span class=\"token punctuation\">}</span> alt<span class=\"token operator\">=</span><span class=\"token string\">\"Attendance Type Icon\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span>showPopOver <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>PopOver <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>AttendanceDetails <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Modal<span class=\"token punctuation\">.</span>Body<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Modal<span class=\"token punctuation\">.</span>Footer<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleSave</span><span class=\"token punctuation\">(</span>recordData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>저장<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Modal<span class=\"token punctuation\">.</span>Footer<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Modal<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">const { iconPath,... } = attendanceStrategies[type]</code> 을 통해 구체적인 로직은 모두 전략에 위임하고 있음을 알 수 있다. 새로운 전략이 생기거나 기존 전략에 수정이 생겨도 전략을 사용하는 부분을 수정할 필요가 없다.</li>\n<li>전략을 사용하는 <code class=\"language-text\">&lt;img src={iconPath} alt=\"Attendance Type Icon\" /> {showPopOver &amp;&amp; &lt;PopOver />}</code> 부분을 보면 근태 타입에 따라 런타임에서 전략이 결정됨을 알 수 있다. (그리고 그 전략의 세부 구현은 <code class=\"language-text\">AttendanceEditModal</code>에서 알 필요가 없다.)</li>\n</ul>\n<h2 id=\"느낀-것들\" style=\"position:relative;\"><a href=\"#%EB%8A%90%EB%82%80-%EA%B2%83%EB%93%A4\" aria-label=\"느낀 것들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>느낀 것들</h2>\n<h3 id=\"도입-과정에서-까다로웠던-점\" style=\"position:relative;\"><a href=\"#%EB%8F%84%EC%9E%85-%EA%B3%BC%EC%A0%95%EC%97%90%EC%84%9C-%EA%B9%8C%EB%8B%A4%EB%A1%9C%EC%9B%A0%EB%8D%98-%EC%A0%90\" aria-label=\"도입 과정에서 까다로웠던 점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>도입 과정에서 까다로웠던 점</h3>\n<p>전략패턴의 예제는 대부분 클래스형으로 되어있는데 (클래스의 관계에 초점을 맞추는 패턴이니 당연한 이야기) 회사 프로젝트의 경우 클래스를 지양하고 있었다. 전략 패턴 도입하자고 뜬금없이 클래스를 만들 수도 없는 노릇이기에, 전략 패턴의 핵심을 파악해 내 프로젝트의 코드에 녹여내려 노력했다.</p>\n<p>그 결과로 클래스 없이 별도의 전략 객체를 만들어 패턴을 적용했다. 일반적인 적용 예제와는 다르지만 패턴의 핵심인 의존성 역전 원칙에 따라 의존성을 분리하고 수정에 용이하도록 만들었다.</p>\n<h3 id=\"도입-후-피부로-느낀-장점\" style=\"position:relative;\"><a href=\"#%EB%8F%84%EC%9E%85-%ED%9B%84-%ED%94%BC%EB%B6%80%EB%A1%9C-%EB%8A%90%EB%82%80-%EC%9E%A5%EC%A0%90\" aria-label=\"도입 후 피부로 느낀 장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>도입 후 피부로 느낀 장점</h3>\n<p>결론부터 말하자면 디자인 패턴 도입 전, 시나리오 절망편으로 상상했던 상황이 모두 일어났다. (사실 다른 팀원이 내가 개발한 부분을 참고해야 하거나 요구사항이 변경되는 일은 그리 특별한 일이 아니기도 하다)</p>\n<p>분기처리가 여기저기에 흩어져있지 않고 한 눈에 확인할 수 있다보니 동료에게 설명하기도 편했고, QA 기간 중 급하게 요구사항이 변경되었을 때도 신속하게 대응할 수 있었다.</p>\n<h2 id=\"세줄-요약\" style=\"position:relative;\"><a href=\"#%EC%84%B8%EC%A4%84-%EC%9A%94%EC%95%BD\" aria-label=\"세줄 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>세줄 요약</h2>\n<ol>\n<li>복잡하고 반복되는 분기처리가 고민이라면 전략 패턴 도입이 하나의 선택지가 될 수 있다.</li>\n<li>추상화 과정이 까다로울 수 있지만 흩어진 분기처리를 일관된 구조로 모으고, 요구사항 변경에 유연하게 대응할 수 있다.</li>\n<li>분기처리의 수가 적거나 변경이 거의 없을 땐 다시 생각해보자</li>\n</ol>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\">들어가며</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%84%EB%9E%B5%ED%8C%A8%ED%84%B4%EC%97%90-%EA%B4%80%EC%8B%AC%EC%9D%84-%EA%B0%80%EC%A7%80%EA%B2%8C-%EB%90%9C-%EA%B3%84%EA%B8%B0\">전략패턴에 관심을 가지게 된 계기</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4\">디자인 패턴</a></p>\n<ul>\n<li><a href=\"#%EC%83%9D%EC%84%B1-%ED%8C%A8%ED%84%B4-creational-pattern\">생성 패턴 (Creational Pattern)</a></li>\n<li><a href=\"#%EA%B5%AC%EC%A1%B0-%ED%8C%A8%ED%84%B4-structural-pattern\">구조 패턴 (Structural Pattern)</a></li>\n<li><a href=\"#%ED%96%89%EB%8F%99-%ED%8C%A8%ED%84%B4-behavioral-pattern\">행동 패턴 (Behavioral Pattern)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%84%EB%9E%B5-%ED%8C%A8%ED%84%B4\">전략 패턴</a></p>\n<ul>\n<li><a href=\"#%EC%A3%BC%EC%9A%94-%ED%8A%B9%EC%A7%95\">주요 특징</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%8F%84%EC%9E%85-%EA%B3%BC%EC%A0%95\">도입 과정</a></p>\n<ul>\n<li><a href=\"#%EB%AC%B4%EC%97%87%EC%9D%84-%EC%B6%94%EC%83%81%ED%99%94%ED%95%A0%EA%B9%8C\">무엇을 추상화할까?</a></li>\n<li><a href=\"#strategy-concretestrategy-%EC%A0%95%EC%9D%98\">Strategy, ConcreteStrategy 정의</a></li>\n<li><a href=\"#%EC%A0%95%EC%9D%98%ED%95%9C-%EC%A0%84%EB%9E%B5-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">정의한 전략 사용하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%8A%90%EB%82%80-%EA%B2%83%EB%93%A4\">느낀 것들</a></p>\n<ul>\n<li><a href=\"#%EB%8F%84%EC%9E%85-%EA%B3%BC%EC%A0%95%EC%97%90%EC%84%9C-%EA%B9%8C%EB%8B%A4%EB%A1%9C%EC%9B%A0%EB%8D%98-%EC%A0%90\">도입 과정에서 까다로웠던 점</a></li>\n<li><a href=\"#%EB%8F%84%EC%9E%85-%ED%9B%84-%ED%94%BC%EB%B6%80%EB%A1%9C-%EB%8A%90%EB%82%80-%EC%9E%A5%EC%A0%90\">도입 후 피부로 느낀 장점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%84%B8%EC%A4%84-%EC%9A%94%EC%95%BD\">세줄 요약</a></p>\n</li>\n</ul>\n</div>","excerpt":"들어가며 최근 소속된 개발자 커뮤니티의 네트워킹 행사에서 반복되는 분기처리에 전략패턴 도입하기라는 제목으로 발표를 했다. 주제를 정해 발표 자료를 준비하고 피드백을 요청해 다듬어나간 경험만으로도 즐겁고 알찬 경험이었지만, 글로도 남겨보면 더 오래오래 남을 것 같아 블로그에도 정리해본다. 전략패턴에 관심을 가지게 된 계기 인력 관리 솔루션의 출퇴근 기능을 담당하며 다양한 근태 타입과 사용자 권한에 따른 따른 분기처리가 필요했다. 서비스 특성상 스케줄 등 다른 기능을 개발하는 팀원이 내 코드를 참고할 일도 있을 것이고, 추후 요구사항이 변동될 가능성도 있어(세상엔 내 생각보다 다양한 근태 유형이 존재했다..) 가독성과 유지보수에 대한 고민이 많았다. 머릿속을 스쳐지나간 절망편 시나리오들··· \n 고민을 이어나가던 도중 개발 커뮤니티에서 보았던 디자인 패턴은 내 코드를 공용어로 만든다는 문장이 떠올랐고, 이를 인사이트 삼아 디자인 패턴을 적용해보자는 생각이 들었다. 디자인 패턴 Desi…","frontmatter":{"date":"July 15, 2024","title":"반복되는 분기처리에 전략패턴 도입하기","categories":"React","author":"Bomdong","emoji":"🔁"},"fields":{"slug":"/react-strategy-pattern/"}},"next":{"id":"32a32177-2e0d-574e-8559-6da1df2d37c6","html":"<blockquote>\n<p>본 글은 원글 <a href=\"https://www.patterns.dev/react/hoc-pattern\">patterns - HOC Pattern</a>을 학습용으로 번역한 것입니다.</p>\n</blockquote>\n<h1 id=\"고차-컴포넌트-패턴\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EC%B0%A8-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%ED%8C%A8%ED%84%B4\" aria-label=\"고차 컴포넌트 패턴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>고차 컴포넌트 패턴</h1>\n<p>애플리케이션에서 여러 컴포넌트에 동일한 로직을 사용하고자 할 때가 있습니다. <br/>\n이 로직에는 컴포넌트에 특정한 스타일링을 적용시키는 것, 권한 요구, 전역 상태룰 추가하는 것 등이 포함될 수 있습니다.</p>\n<p>여러 컴포넌트에서 같은 로직을 재사용할 수 있도록 하는 방법 중 하나는 고차 컴포넌트 패턴을 사용하는 것입니다. <br/>\n이 패턴으로 애플리케이션 전체에서 컴포넌트 로직을 재사용할 수 있습니다.</p>\n<p>고차 컴포넌트(HOC)는 또다른 컴포넌트를 전달받는 컴포넌트입니다. <br/>\n고차 컴포넌트는 매개변수로 전달하는 컴포넌트에 적용시키고자 하는 특정 로직을 포함하고 있습니다.\n해당 로직을 적용한 후, 고차 컴포넌트는 추가적인 로직이 포함된 요소를 반환합니다.</p>\n<p>애플리케이션에서 여러 컴포넌트에 특정한 스타일링을 추가하고 싶다고 가정해봅시다. <br/>\n매번 로컬에서 style 객체를 만드는 대신, 전달하는 컴포넌트에 style 객체를 적용시키는 고차 컴포넌트를 만들 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.2rem'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token string\">'1rem'</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Component style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> Button <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span>Click me<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Text</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>Hello World<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">const</span> StyledButton <span class=\"token operator\">=</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span>Button<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> StyledText <span class=\"token operator\">=</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span>Text<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Button, Text 컴포넌트를 StyledButton, StyledText 컴포넌트를 만들었습니다. <br/>\n두 컴포넌트는 <code class=\"language-text\">withStyles</code> 고차 컴포넌트에 추가된 스타일을 포함하고 있습니다.</p>\n<p>이전에 Container/Presentation 패턴에서 사용했던 <code class=\"language-text\">DogImages</code> 예시를 살펴보겠습니다!\n이 애플리케이션은 API에서 받아온 <code class=\"language-text\">DogImages</code> 목록을 렌더링하는 것 외에는 아무것도 하지 않습니다.</p>\n<p>사용자 경험을 조금 개선해 보겠습니다.\n데이터를 가져올 때 사용자에게 “로딩 중…” 화면을 표시하고 싶습니다.\nDogImages 컴포넌트에 데이터를 직접 추가하는 대신 해당 로직을 추가하는 고차 컴포넌트를 사용할 수 있습니다.</p>\n<p>withLoader라는 고차 컴포넌트를 만들어봅시다.\n고차 컴포넌트는 컴포넌트를 전달받고, 해당 컴포넌트를 반환해야합니다.\n이 경우, withLoader 고차 컴포넌트는 데이터를 가져올 때까지 Loading…을 보여주는 요소를 전달받아야 합니다.</p>\n<p>최소한을 구현한 withLoader 고차 컴포넌트를 만들어봅시다!</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>Element <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>하지만 단순히 전달받은 요소를 반환하는 것을 원하지는 않습니다.\n데이터가 로드되고 있는지를 알려주는 로직을 포함시키고자 합니다.</p>\n<p>재사용성을 높이기 위해서, withLoader 고차 컴포넌트에 Dog API url을 하드코딩하지 않을 것입니다. 대신 url을 인수로 전달하면 API 엔드포인트에서 데이터를 가져오는동안 로딩 표시가 필요한 모든 컴포넌트에서 이 로더를 사용할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Element<span class=\"token punctuation\">,</span> url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>고차 컴포넌트는 요소(이 경우 함수형 컴포넌트 <code class=\"language-text\">props => {}</code>)를 반환하며, 여기에 데이터가 아직 불러와지고 있을 때 Loading… 글씨를 보여주는 로직을 추가하려 합니다.\n데이터를 불러오면 컴포넌트는 불러온 데이터를 prop으로 전달해야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useEffect<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Element<span class=\"token punctuation\">,</span> url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">,</span> setData<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">setData</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>Loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Element <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>완벽합니다!\n방금 모든 컴포넌트와 url을 전달받는 고차 컴포넌트를 만들었습니다.</p>\n<ol>\n<li>\n<p>useEffect 훅에서 <code class=\"language-text\">withLoader</code> 고차 컴포넌트는 <code class=\"language-text\">url</code> 값으로 전달한 API 엔드포인트에서 데이터를 가져옵니다.\n데이터가 아직 반환되지 않은 동안에는 Loading… 텍스트가 포함된 요소를 반환합니다.</p>\n</li>\n<li>\n<p>데이터를 가져온 후에는 가져온 데이터와 동일한 <code class=\"language-text\">data</code>를 설정합니다.\n<code class=\"language-text\">data</code>가 더 이상 null이 아니므로 고차 컴포넌트에 전달한 요소를 표시할 수 있습니다!</p>\n<p>그렇다면 어플리케이션에 이 동작을 추가해서 <code class=\"language-text\">DogImages</code> 목록에 로딩 중…을 표시하려면 어떻게 해야 할까요?</p>\n</li>\n</ol>\n<p><code class=\"language-text\">DogImages.js</code>는 더 이상 일반 DogImages 컴포넌트를 반환하지 않습니다.\n대신, DogImages 컴포넌트를 “래핑하는” <code class=\"language-text\">withLoading</code> 고차 컴포넌트를 반환하고자 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withLoading</span><span class=\"token punctuation\">(</span>DogImages<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>withLoader 고차 컴포넌트는 url이 어떤 엔드포인트에서 데이터를 가져오는지를 알기를 기대합니다.\n이 경우 Dog API 엔드포인트를 추가하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span>DogImages<span class=\"token punctuation\">,</span> <span class=\"token string\">'https://dog.ceo/api/breed/labrador/images/random/6'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이 경우 withLoader 고차 컴포넌트는 별도의 <code class=\"language-text\">data</code> prop인 <code class=\"language-text\">DogImages</code>가 포함된 요소를 반환하므로, <code class=\"language-text\">DogImages</code> 컴포넌트에서 <code class=\"language-text\">data</code> prop에 접근할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> withLoader <span class=\"token keyword\">from</span> <span class=\"token string\">'./withLoader'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">DogImages</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dog<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>dog<span class=\"token punctuation\">}</span> alt<span class=\"token operator\">=</span><span class=\"token string\">\"Dog\"</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span>DogImages<span class=\"token punctuation\">,</span> <span class=\"token string\">'https://dog.ceo/api/breed/labrador/images/random/6'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"합성\" style=\"position:relative;\"><a href=\"#%ED%95%A9%EC%84%B1\" aria-label=\"합성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>합성</h2>\n<p>여러 개의 고차 컴포넌트를 합성할 수도 있습니다.\n사용자가 <code class=\"language-text\">DogImages</code> 목록 위로 마우스를 가져가면 Hovering! 텍스트 상자를 표시하는 기능을 추가한다고 가정해 봅시다.</p>\n<p>전달할 요소에 <code class=\"language-text\">hovering</code> 프로퍼티를 제공하는 고차 컴포넌트를 만들어야 합니다. 이 프로퍼티를 기반으로 사용자가 <code class=\"language-text\">DogImages</code> 목록 위로 마우스를 가져갔는지 여부에 따라 텍스트 상자를 렌더링할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">withHover</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>hovering<span class=\"token punctuation\">,</span> setHover<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Element\n        <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span>\n        hovering<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hovering<span class=\"token punctuation\">}</span>\n        onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setHover</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n        onMouseLeave<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setHover</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이제 withHover 고차 컴포넌트를 withLoader 고차 컴포넌트에 래핑할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> withLoader <span class=\"token keyword\">from</span> <span class=\"token string\">'./withLoader'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> withHover <span class=\"token keyword\">from</span> <span class=\"token string\">'./withHover'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">DogImages</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>hovering <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"hover\"</span><span class=\"token operator\">></span>Hovering<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"list\"</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dog<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>dog<span class=\"token punctuation\">}</span> alt<span class=\"token operator\">=</span><span class=\"token string\">\"Dog\"</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withHover</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span>DogImages<span class=\"token punctuation\">,</span> <span class=\"token string\">'https://dog.ceo/api/breed/labrador/images/random/6'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이제 <code class=\"language-text\">DogImages</code> 요소에는 <code class=\"language-text\">withHover</code>와 withLoader에서 전달한 모든 프로퍼티가 포함됩니다.\n호버링 프로퍼티의 값이 참인지 거짓인지에 따라 Hovering! 텍스트 상자를 조건부로 렌더링할 수 있습니다.</p>\n<blockquote>\n<p>고차 컴포넌트를 작성하는 데 사용되는 잘 알려진 라이브러리는 <a href=\"https://github.com/acdlite/recompose\">recompose</a>입니다. 고차 컴포넌트는 대부분 React Hook으로 대체할 수 있기 때문에 recompose 라이브러리는 더 이상 유지되지 않으므로 이 글에서는 다루지 않겠습니다.</p>\n</blockquote>\n<h2 id=\"hooks\" style=\"position:relative;\"><a href=\"#hooks\" aria-label=\"hooks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooks</h2>\n<p>경우에 따라 고차 컴포넌트 패턴을 React Hook으로 대체할 수 있습니다.</p>\n<p><code class=\"language-text\">withHover</code> 고차 컴포넌트를 <code class=\"language-text\">useHover</code> 훅으로 대체해 보겠습니다. 고차 컴포넌트 대신 mouseOver와 mouseLeave 이벤트 리스너를 요소에 추가하는 훅을 내보냅니다. 고차 컴포넌트에서 했던 것처럼 더 이상 요소를 전달할 수 없습니다. 대신 mouseOver 및 mouseLeave 이벤트를 가져와야 하는 훅에서 ref를 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useRef<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useHover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>hovering<span class=\"token punctuation\">,</span> setHover<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> ref <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseOver</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setHover</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseOut</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setHover</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> ref<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mouseover'</span><span class=\"token punctuation\">,</span> handleMouseOver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      node<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mouseout'</span><span class=\"token punctuation\">,</span> handleMouseOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mouseover'</span><span class=\"token punctuation\">,</span> handleMouseOver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        node<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mouseout'</span><span class=\"token punctuation\">,</span> handleMouseOut<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>ref<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>ref<span class=\"token punctuation\">,</span> hovering<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>useEffect 훅은 컴포넌트에 이벤트 리스너를 추가하고 사용자가 현재 요소 위에 마우스를 올려놓았는지 여부에 따라 hovering 값을 true 또는 false로 설정합니다. 마우스오버와 마우스리브 이벤트를 수신해야 하는 컴포넌트에 참조를 추가하려면 참조와 호버링 값을 모두 반환해야 하며, 조건부로 호버링! 텍스트 상자를 렌더링할 수 있도록 하려면 호버링 값을 반환해야 합니다.</p>\n<p>도그이미지 컴포넌트를 withHover 고차 컴포넌트로 감싸는 대신, 도그이미지 컴포넌트 내부에서 바로 useHover 훅을 사용할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> withLoader <span class=\"token keyword\">from</span> <span class=\"token string\">'./withLoader'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> useHover <span class=\"token keyword\">from</span> <span class=\"token string\">'./useHover'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">DogImages</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>hoverRef<span class=\"token punctuation\">,</span> hovering<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useHover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hoverRef<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>hovering <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"hover\"</span><span class=\"token operator\">></span>Hovering<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"list\"</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dog<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>dog<span class=\"token punctuation\">}</span> alt<span class=\"token operator\">=</span><span class=\"token string\">\"Dog\"</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withLoader</span><span class=\"token punctuation\">(</span>DogImages<span class=\"token punctuation\">,</span> <span class=\"token string\">'https://dog.ceo/api/breed/labrador/images/random/6'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>완벽합니다! DogImages 컴포넌트를 withHover 컴포넌트로 감싸는 대신, 컴포넌트 내에서 직접 useHover 훅을 사용할 수 있습니다.</p>\n<p>일반적으로 React Hook은 고차 컴포넌트 패턴을 대체하지 않습니다.</p>\n<p>“대부분의 경우 Hook으로 충분하며 트리에서 중첩을 줄이는 데 도움이 될 수 있습니다.” - React 문서</p>\n<p>React 문서에 따르면 Hook을 사용하면 컴포넌트 트리의 깊이를 줄일 수 있습니다. 고차 컴포넌트 패턴을 사용하면 컴포넌트 트리가 깊게 중첩되기 쉽습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>withAuth<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>withLayout<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>withLogging<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Component <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>withLogging<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>withLayout<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>withAuth<span class=\"token operator\">></span></code></pre></div>\n<p>컴포넌트에 Hook을 직접 추가하면 더 이상 컴포넌트를 래핑할 필요가 없습니다.</p>\n<p>상위 컴포넌트를 사용하면 동일한 로직을 한 곳에 유지하면서 여러 컴포넌트에 동일한 로직을 제공할 수 있습니다. 후크를 사용하면 컴포넌트 내에서 사용자 정의 동작을 추가할 수 있으므로 여러 컴포넌트가 이 동작에 의존하는 경우 고차 컴포넌트 패턴에 비해 버그가 발생할 위험이 높아질 수 있습니다.</p>\n<h3 id=\"고차-컴포넌트의-모범-사용-사례\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EC%B0%A8-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EC%9D%98-%EB%AA%A8%EB%B2%94-%EC%82%AC%EC%9A%A9-%EC%82%AC%EB%A1%80\" aria-label=\"고차 컴포넌트의 모범 사용 사례 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>고차 컴포넌트의 모범 사용 사례:</h3>\n<p>애플리케이션 전체에서 여러 컴포넌트에서 사용자 정의되지 않은 동일한 동작을 사용해야 하는 경우.\n컴포넌트는 사용자 정의 로직을 추가하지 않고 독립적으로 작동할 수 있습니다.</p>\n<h3 id=\"hook의-모범-사용-사례\" style=\"position:relative;\"><a href=\"#hook%EC%9D%98-%EB%AA%A8%EB%B2%94-%EC%82%AC%EC%9A%A9-%EC%82%AC%EB%A1%80\" aria-label=\"hook의 모범 사용 사례 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hook의 모범 사용 사례:</h3>\n<p>동작을 사용하는 각 컴포넌트에 대해 동작을 사용자 정의해야 합니다.\n동작이 애플리케이션 전체에 퍼지지 않고 하나 또는 몇 개의 컴포넌트만 동작을 사용합니다.\n이 동작은 컴포넌트에 많은 속성을 추가합니다.</p>\n<h2 id=\"사례-연구\" style=\"position:relative;\"><a href=\"#%EC%82%AC%EB%A1%80-%EC%97%B0%EA%B5%AC\" aria-label=\"사례 연구 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>사례 연구</h2>\n<p>고차 컴포넌트 패턴에 의존하던 일부 라이브러리는 릴리스 이후 Hook 지원을 추가했습니다. 그 좋은 예가 Apollo 클라이언트입니다.</p>\n<p>이 예제를 이해하는 데 Apollo Client에 대한 경험이 없어도 됩니다.</p>\n<p>Apollo Client를 사용하는 한 가지 방법은 graphql() 고차 컴포넌트를 사용하는 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-apollo'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">ADD_MESSAGE</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./resolvers'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Input</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">handleChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">mutate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">variables</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>message <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"input-row\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>input onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span> type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span> placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"Type something...\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Add<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADD_MESSAGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>graphql() 고차 컴포넌트를 사용하면 클라이언트의 데이터를 상위 컴포넌트에 의해 래핑된 컴포넌트에서 사용할 수 있게 만들 수 있습니다! 현재도 graphql() 고차 컴포넌트를 사용할 수 있지만, 몇 가지 단점이 있습니다.</p>\n<p>컴포넌트가 여러 리졸버에 액세스해야 하는 경우, 이를 위해 여러 개의 graphql() 상위 컴포넌트를 작성해야 합니다. 여러 개의 고차 컴포넌트를 구성하면 데이터가 컴포넌트에 전달되는 방식을 이해하기 어려울 수 있습니다. 경우에 따라 고차 컴포넌트의 순서가 중요할 수 있으며, 이는 코드를 리팩토링할 때 쉽게 버그로 이어질 수 있습니다.</p>\n<p>Hook이 출시된 후 Apollo는 Apollo 클라이언트 라이브러리에 Hook 지원을 추가했습니다. 이제 개발자는 graphql() 고차 컴포넌트를 사용하는 대신 라이브러리가 제공하는 후크를 통해 데이터에 직접 액세스할 수 있습니다.</p>\n<p>앞서 예제에서 보았던 graphql() 고차 컴포넌트를 사용한 예제와 정확히 동일한 데이터를 사용하는 예제를 살펴보겠습니다. 이번에는 아폴로 클라이언트가 제공한 useMutation 훅을 사용하여 데이터를 컴포넌트에 제공하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./styles.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useMutation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@apollo/react-hooks'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">ADD_MESSAGE</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./resolvers'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>message<span class=\"token punctuation\">,</span> setMessage<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>addMessage<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMutation</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADD_MESSAGE</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">variables</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> message <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"input-row\"</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>input\n        onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setMessage</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n        type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"Type something...\"</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>addMessage<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Add<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>useMutation 훅을 사용하여 컴포넌트에 데이터를 제공하기 위해 필요한 코드의 양을 줄였습니다.</p>\n<p>상용구가 줄어든 것 외에도 컴포넌트에서 여러 리졸버의 데이터를 사용하는 것이 훨씬 쉬워졌습니다. 여러 개의 상위 컴포넌트를 작성할 필요 없이 컴포넌트에 여러 개의 후크를 작성하기만 하면 됩니다. 이렇게 하면 데이터가 컴포넌트에 전달되는 방식을 훨씬 쉽게 파악할 수 있으며, 컴포넌트를 리팩토링하거나 더 작은 조각으로 나눌 때 개발자 경험을 개선할 수 있습니다.</p>\n<h2 id=\"장점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h2>\n<p>고차 컴포넌트 패턴을 사용하면 재사용하려는 로직을 모두 한 곳에 보관할 수 있습니다. 이렇게 하면 코드를 계속 복제해 실수로 실수로 애플리케이션 전체에 버그를 퍼뜨려 매번 새로운 버그가 발생할 위험을 줄일 수 있습니다. 로직을 모두 한 곳에 보관하면 코드가 깔끔하게 유지되고 관심사를 쉽게 분리할 수 있습니다.</p>\n<h2 id=\"단점\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h2>\n<p>고차 컴포넌트로 요소에 전달하는 프로퍼티명에서 충돌이 발생할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.2rem'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token string\">'1rem'</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Component style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> Button <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>button style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">'red'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click me<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n<span class=\"token keyword\">const</span> StyledButton <span class=\"token operator\">=</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span>Button<span class=\"token punctuation\">)</span></code></pre></div>\n<p>이 경우, withStyles 고차 컴포넌트는 전달한 요소에 스타일이라는 프로퍼티를 추가합니다. <br/>\n하지만 버튼 컴포넌트에는 이미 스타일이라는 프로퍼티가 있으므로 덮어쓰게 됩니다! <br/>\n프로퍼티 이름을 바꾸거나 프로퍼티를 병합하여 고차 컴포넌트가 프로퍼티명 충돌을 처리할 수 있는지 확인하세요.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Component</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.2rem'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token string\">'1rem'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>props<span class=\"token punctuation\">.</span>style\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Component style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> Button <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>button style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">'red'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click me<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n<span class=\"token keyword\">const</span> StyledButton <span class=\"token operator\">=</span> <span class=\"token function\">withStyles</span><span class=\"token punctuation\">(</span>Button<span class=\"token punctuation\">)</span></code></pre></div>\n<p>프로퍼티를 모두 그 안에 래핑된 요소로 전달하는 여러 개의 구성된 고차 컴포넌트를 사용하는 경우 <br/>\n어떤 고차 컴포넌트가 어떤 소품을 담당하는지 파악하기 어려울 수 있습니다. <br/>\n이는 애플리케이션을 쉽게 디버깅하고 확장하는 데 방해가 될 수 있습니다.</p>\n<h2 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h2>\n<p><a href=\"https://legacy.reactjs.org/docs/higher-order-components.html\">Higher-Order Components - React</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%ED%95%A9%EC%84%B1\">합성</a></p>\n</li>\n<li>\n<p><a href=\"#hooks\">Hooks</a></p>\n<ul>\n<li><a href=\"#%EA%B3%A0%EC%B0%A8-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EC%9D%98-%EB%AA%A8%EB%B2%94-%EC%82%AC%EC%9A%A9-%EC%82%AC%EB%A1%80\">고차 컴포넌트의 모범 사용 사례:</a></li>\n<li><a href=\"#hook%EC%9D%98-%EB%AA%A8%EB%B2%94-%EC%82%AC%EC%9A%A9-%EC%82%AC%EB%A1%80\">Hook의 모범 사용 사례:</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%82%AC%EB%A1%80-%EC%97%B0%EA%B5%AC\">사례 연구</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9E%A5%EC%A0%90\">장점</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8B%A8%EC%A0%90\">단점</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\">참고자료</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"March 17, 2024","title":"[번역] HOC Pattern","categories":"React","author":"Bomdong","emoji":"🪆"},"fields":{"slug":"/react-hoc-pattern/"}},"prev":{"id":"691cc32a-5054-579b-a89b-2fb1a80394d6","html":"<h2 id=\"들어가며\" style=\"position:relative;\"><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\" aria-label=\"들어가며 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>들어가며</h2>\n<p>7월부터 주 5일, 하루 30분씩 개발 탐구를 하는 시간을 가져보자라는 습관 만들기를 시작했고, 5일을 채우지 못할 때가 있어도 느슨하게 지속해나가고 있다.\n매일 사용하는 React와 더 친해져보고 싶다는 생각이 들어 내부 구현에 대한 아티클을 하나 둘씩 찾아 읽어보다가 이미 유명한 Dan abramov의 블로그의 글 <a href=\"https://overreacted.io/a-complete-guide-to-useeffect/\">A Complete Guide to useEffect</a>에서 <strong>useEffect는 lifecycle보다는 data의 동기화 메커니즘으로 바라보아야 한다</strong>는 문장에 제대로 꽂혔다.</p>\n<blockquote>\n<p>To get productive, you need to “think in effects”, and their mental model is closer to implementing synchronization than to responding to lifecycle events.</p>\n</blockquote>\n<p>그 전까진 useEffect는 대략 lifecycle, dependency에 따라 실행된다라고 뭉뚱그려 알고있던 터라 저 문장이 불명확하게 다가왔다. 나 빼고 다들 이해하고 있던건가.. useEffect의 내부 구현은 어떻게 구성되어있길래..?싶은 생각이 들었고, 제목은 거창하게 적어두었지만 결국 React 코드를 헤엄친 여정인 이 글이 탄생하게 된다.</p>\n<blockquote>\n<p>React 19를 기준으로 작성했으며, 인용한 코드에서 DEV 관련 코드, 주석은 때에 따라 생략했다.</p>\n</blockquote>\n<h2 id=\"useeffect의-실행-과정\" style=\"position:relative;\"><a href=\"#useeffect%EC%9D%98-%EC%8B%A4%ED%96%89-%EA%B3%BC%EC%A0%95\" aria-label=\"useeffect의 실행 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useEffect의 실행 과정</h2>\n<p>React 코드에서의 useEffect를 찾아 떠나보자. <br/></p>\n<h3 id=\"dispatcheruseeffect와-렌더링-단계별-처리\" style=\"position:relative;\"><a href=\"#dispatcheruseeffect%EC%99%80-%EB%A0%8C%EB%8D%94%EB%A7%81-%EB%8B%A8%EA%B3%84%EB%B3%84-%EC%B2%98%EB%A6%AC\" aria-label=\"dispatcheruseeffect와 렌더링 단계별 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>dispatcher.useEffect와 렌더링 단계별 처리</h3>\n<p>가장 먼저, 여러 hook의 기본 선언이 이루어져있는 <code class=\"language-text\">ReactHooks.js</code>에서 찾을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//ReactHooks.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span>\n  deps<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>mixed<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> dispatcher <span class=\"token operator\">=</span> <span class=\"token function\">resolveDispatcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> dispatcher<span class=\"token punctuation\">.</span><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span>create<span class=\"token punctuation\">,</span> deps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>useEffect가 호출되면 resolveDispatcher함수에서 리턴되는 dispatcher의 useEffect가 실행된다.</p>\n<blockquote>\n<p>dispatcher는 React hook의 구현을 포함하고 있는 객체로, 렌더링 단계에 따라 적절한 hook이 구현되도록 제공한다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">resolveDispatcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> dispatcher <span class=\"token operator\">=</span> ReactSharedInternals<span class=\"token punctuation\">.</span><span class=\"token constant\">H</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>__DEV__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dispatcher <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>\n        <span class=\"token string\">'Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for'</span> <span class=\"token operator\">+</span>\n          <span class=\"token string\">' one of the following reasons:\\n'</span> <span class=\"token operator\">+</span>\n          <span class=\"token string\">'1. You might have mismatching versions of React and the renderer (such as React DOM)\\n'</span> <span class=\"token operator\">+</span>\n          <span class=\"token string\">'2. You might be breaking the Rules of Hooks\\n'</span> <span class=\"token operator\">+</span> <span class=\"token operator\">...</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>dispatcher<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Dispatcher<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">resolveDispatcher</code> 함수를 살펴보면 dispatcher를 <code class=\"language-text\">ReactSharedInternals.H</code>라는 값에서 가져오고 있다.</p>\n<blockquote>\n<p>개발모드일 때 <strong>Invalid hook call. Hooks can only be called inside of the body of a function component</strong> 이 에러가 resolveDispatcher 내부에서 dispatcher가 null일 때 나는 것이였구나.. 깨달음이 +1 되었다.💡  React는 컴포넌트를 렌더링할 때 dispatcher를 설정하니 렌더링 사이클 외부에서 hook을 호출하려고 하면 dispatcher가 null일수밖에 없다.</p>\n</blockquote>\n<p>다시 돌아가서, <code class=\"language-text\">ReactSharedInternals.H</code>를 찾아보자.\n<code class=\"language-text\">renderWithHooks</code> 함수는 component의 렌더링이 시작되면 호출되는데, 여기서 <code class=\"language-text\">ReactSharedInternals.H</code>에 Fiber의 상태에 따라 달라지는 dispatcher를 할당하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">ReactSharedInternals<span class=\"token punctuation\">.</span><span class=\"token constant\">H</span> <span class=\"token operator\">=</span>\n  current <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> current<span class=\"token punctuation\">.</span>memoizedState <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span>\n    <span class=\"token operator\">?</span> HooksDispatcherOnMount\n    <span class=\"token operator\">:</span> HooksDispatcherOnUpdate<span class=\"token punctuation\">;</span></code></pre></div>\n<p>component가 처음 mount되면 <code class=\"language-text\">HooksDispatcherOnMount</code>, update될 땐 <code class=\"language-text\">HooksDispatcherOnUpdate</code>가 할당되는데, 각각의 dispatcher는 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> HooksDispatcherOnMount<span class=\"token operator\">:</span> Dispatcher <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  readContext<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n  useEffect<span class=\"token operator\">:</span> mountEffect<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> HooksDispatcherOnUpdate<span class=\"token operator\">:</span> Dispatcher <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  readContext<span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n  useEffect<span class=\"token operator\">:</span> updateEffect<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>각각의 dispatcher의 useEffect엔 mountEffect 혹은 updateEffect가 매칭된다.\nuseEffect 함수의 <code class=\"language-text\">dispatcher.useEffect(create, deps);</code>에서의 dispatcher를 이제야 확인한 셈.</p>\n<h3 id=\"effect-생성-및-스케쥴링\" style=\"position:relative;\"><a href=\"#effect-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EC%8A%A4%EC%BC%80%EC%A5%B4%EB%A7%81\" aria-label=\"effect 생성 및 스케쥴링 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>effect 생성 및 스케쥴링</h3>\n<p>mounteffect와 updateEffect의 실제 구현은 <code class=\"language-text\">mountEffectImpl</code> , <code class=\"language-text\">updateEffectImpl</code>에서 이루어지고, 두 함수 모두 <code class=\"language-text\">pushEffect</code> 함수를 호출하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">mountEffect</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span>\n  deps<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>mixed<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token operator\">...</span>\n    <span class=\"token function\">mountEffectImpl</span><span class=\"token punctuation\">(</span>\n      PassiveEffect <span class=\"token operator\">|</span> PassiveStaticEffect<span class=\"token punctuation\">,</span>\n      HookPassive<span class=\"token punctuation\">,</span>\n      create<span class=\"token punctuation\">,</span>\n      deps<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">mountEffectImpl</span><span class=\"token punctuation\">(</span>\n  fiberFlags<span class=\"token operator\">:</span> Flags<span class=\"token punctuation\">,</span>\n  hookFlags<span class=\"token operator\">:</span> HookFlags<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span>\n  deps<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>mixed<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> hook <span class=\"token operator\">=</span> <span class=\"token function\">mountWorkInProgressHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> nextDeps <span class=\"token operator\">=</span> deps <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">:</span> deps<span class=\"token punctuation\">;</span>\n  currentlyRenderingFiber<span class=\"token punctuation\">.</span>flags <span class=\"token operator\">|=</span> fiberFlags<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//pushEffect 호출</span>\n  hook<span class=\"token punctuation\">.</span>memoizedState <span class=\"token operator\">=</span> <span class=\"token function\">pushEffect</span><span class=\"token punctuation\">(</span>\n    HookHasEffect <span class=\"token operator\">|</span> hookFlags<span class=\"token punctuation\">,</span>\n    create<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">createEffectInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    nextDeps<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">updateEffect</span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span> deps<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>mixed<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">updateEffectImpl</span><span class=\"token punctuation\">(</span>PassiveEffect<span class=\"token punctuation\">,</span> HookPassive<span class=\"token punctuation\">,</span> create<span class=\"token punctuation\">,</span> deps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateEffectImpl</span><span class=\"token punctuation\">(</span>\n  fiberFlags<span class=\"token operator\">:</span> Flags<span class=\"token punctuation\">,</span>\n  hookFlags<span class=\"token operator\">:</span> HookFlags<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span>\n  deps<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>mixed<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> hook <span class=\"token operator\">=</span> <span class=\"token function\">updateWorkInProgressHook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> nextDeps <span class=\"token operator\">=</span> deps <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">:</span> deps<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> effect<span class=\"token operator\">:</span> Effect <span class=\"token operator\">=</span> hook<span class=\"token punctuation\">.</span>memoizedState<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> inst <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">.</span>inst<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>currentHook <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nextDeps <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> prevEffect<span class=\"token operator\">:</span> Effect <span class=\"token operator\">=</span> currentHook<span class=\"token punctuation\">.</span>memoizedState<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> prevDeps <span class=\"token operator\">=</span> prevEffect<span class=\"token punctuation\">.</span>deps<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">areHookInputsEqual</span><span class=\"token punctuation\">(</span>nextDeps<span class=\"token punctuation\">,</span> prevDeps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        hook<span class=\"token punctuation\">.</span>memoizedState <span class=\"token operator\">=</span> <span class=\"token function\">pushEffect</span><span class=\"token punctuation\">(</span>hookFlags<span class=\"token punctuation\">,</span> create<span class=\"token punctuation\">,</span> inst<span class=\"token punctuation\">,</span> nextDeps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  currentlyRenderingFiber<span class=\"token punctuation\">.</span>flags <span class=\"token operator\">|=</span> fiberFlags<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//pushEffect 호출</span>\n  hook<span class=\"token punctuation\">.</span>memoizedState <span class=\"token operator\">=</span> <span class=\"token function\">pushEffect</span><span class=\"token punctuation\">(</span>HookHasEffect <span class=\"token operator\">|</span> hookFlags<span class=\"token punctuation\">,</span> create<span class=\"token punctuation\">,</span> inst<span class=\"token punctuation\">,</span> nextDeps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">updateEffectImpl</code>에선 의존성 배열을 순회하면서 <code class=\"language-text\">areHookInputsEqual</code> 함수로 이전 의존성과 새로운 의존성을 비교하는 절차를 거친다.</p>\n<p>두 의존성이 달라질 때 React에게 이 Fiber에 변경사항이 있음을 알려주고 (<code class=\"language-text\">currentlyRenderingFiber.flags |= fiberFlags;</code> ) pusshEffect에 첫 번째 인자로 <code class=\"language-text\">HookHasEffect | hookFlags</code>를 전달한다. HookHasEffect는 <a href=\"https://dev-bomdong.github.io/react-useEffect/#effect-%EA%B0%9D%EC%B2%B4%EC%9D%98-tag\">비트플래그</a>로, commit phase에서 어떤 effect를 실행할지 결정하는데 사용되므로, 이 effect가 이번 렌더링 사이클에서 실행되어야 함을 나타낸다.</p>\n<h4 id=\"pusheffect\" style=\"position:relative;\"><a href=\"#pusheffect\" aria-label=\"pusheffect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pushEffect()</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">pushEffect</span><span class=\"token punctuation\">(</span>\n  tag<span class=\"token operator\">:</span> HookFlags<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">create</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">,</span>\n  inst<span class=\"token operator\">:</span> EffectInstance<span class=\"token punctuation\">,</span>\n  deps<span class=\"token operator\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>mixed<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Effect <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> effect<span class=\"token operator\">:</span> Effect <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    tag<span class=\"token punctuation\">,</span>\n    create<span class=\"token punctuation\">,</span>\n    inst<span class=\"token punctuation\">,</span>\n    deps<span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Circular</span>\n    next<span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> componentUpdateQueue<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">|</span> FunctionComponentUpdateQueue <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span>currentlyRenderingFiber<span class=\"token punctuation\">.</span>updateQueue<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//component의 updateQueue 가져옴</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>componentUpdateQueue <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// updateQueue가 없으면 새로 생성</span>\n    componentUpdateQueue <span class=\"token operator\">=</span> <span class=\"token function\">createFunctionComponentUpdateQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    currentlyRenderingFiber<span class=\"token punctuation\">.</span>updateQueue <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>componentUpdateQueue<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    componentUpdateQueue<span class=\"token punctuation\">.</span>lastEffect <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> lastEffect <span class=\"token operator\">=</span> componentUpdateQueue<span class=\"token punctuation\">.</span>lastEffect<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>lastEffect <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      componentUpdateQueue<span class=\"token punctuation\">.</span>lastEffect <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> firstEffect <span class=\"token operator\">=</span> lastEffect<span class=\"token punctuation\">.</span>next<span class=\"token punctuation\">;</span>\n      lastEffect<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">;</span>\n      effect<span class=\"token punctuation\">.</span>next <span class=\"token operator\">=</span> firstEffect<span class=\"token punctuation\">;</span>\n      componentUpdateQueue<span class=\"token punctuation\">.</span>lastEffect <span class=\"token operator\">=</span> effect<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> effect<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>pushEffect함수는 effect 객체를 생성하고 component의 updateQueue에 effect를 추가한다.\n<del>effect도 결국 하나의 객체에 지나지 않았구나</del></p>\n<h4 id=\"effect-객체의-tag\" style=\"position:relative;\"><a href=\"#effect-%EA%B0%9D%EC%B2%B4%EC%9D%98-tag\" aria-label=\"effect 객체의 tag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>effect 객체의 tag</h4>\n<p>effect 객체의 <code class=\"language-text\">tag</code>가 뭐지?하고 좀더 찾아봤더니 비트플래그였다. 각각의 tag는 <code class=\"language-text\">ReactHookEffectTags.js</code>에서 더 자세히 찾아볼 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//ReactHookEffectTags.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">HookFlags</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> NoFlags <span class=\"token operator\">=</span> <span class=\"token number\">0b0000</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Represents whether effect should fire.</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> HasEffect <span class=\"token operator\">=</span> <span class=\"token number\">0b0001</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Represents the phase in which the effect (not the clean-up) fires.</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Insertion <span class=\"token operator\">=</span> <span class=\"token number\">0b0010</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Layout <span class=\"token operator\">=</span> <span class=\"token number\">0b0100</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Passive <span class=\"token operator\">=</span> <span class=\"token number\">0b1000</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>NoFlags : 이름 그대로 아무 flag도 설정되어 있지 않음.</li>\n<li>HasEffect : 이번 렌더링 주기에 실행되어야 하는 effect flag</li>\n<li>Passive : 비동기적으로 실행되어야 하는 effect flag (useEffect에서 사용된다)</li>\n<li>Layout : Layout 계산하고 브라우저가 화면 그리기 전, 동기적으로 실행해야 하는 effect flag (useLayoutEffect에서 사용된다)</li>\n<li>Insertion : DOM 삽입 단계에서 실행되어야 하는 (DOM조작이 필요할 때) effect flag</li>\n</ul>\n<blockquote>\n<p>💡 React는 결국 number type인 tag로 effect의 동작과 실행 시점을 나타내고 있던 거였다.</p>\n</blockquote>\n<p><strong>비트 플래그</strong></p>\n<p>궁금증은 꼬리에 꼬리를 물고.. 그럼 비트 플래그에 대해서도 좀더 알아보자.\n비트 플래그의 각 플래그는 2의 거듭제곱 값을 가지며, 이진수로 표현된다.\n<code class=\"language-text\">updateEffectImpl</code>에서 <code class=\"language-text\">pushEffect</code>를 호출했던 코드를 다시 보면,</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">hook<span class=\"token punctuation\">.</span>memoizedState <span class=\"token operator\">=</span> <span class=\"token function\">pushEffect</span><span class=\"token punctuation\">(</span>HookHasEffect <span class=\"token operator\">|</span> hookFlags<span class=\"token punctuation\">,</span> create<span class=\"token punctuation\">,</span> inst<span class=\"token punctuation\">,</span> nextDeps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>여기서 <code class=\"language-text\">HookHasEffect | hookFlags</code>는 기존의 hookFlags에 HookHasEffect를 <strong>추가</strong>함을 뜻한다.</p>\n<h3 id=\"commit-phase에서의-useeffect\" style=\"position:relative;\"><a href=\"#commit-phase%EC%97%90%EC%84%9C%EC%9D%98-useeffect\" aria-label=\"commit phase에서의 useeffect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>commit phase에서의 useEffect</strong></h3>\n<p>VDOM의 변경사항을 DOM에 반영하는 commit phase에 들어서면 변경사항을 실제 DOM에 적용하는 <code class=\"language-text\">commitRoot</code> 함수를 실행하고, 실제 작업은 commitRootImpl 함수에서 이루어진다. (##함수의 실제 구현은 추상화된 ##Impl 함수에서 이루어지는 경우가 대부분인듯)</p>\n<h4 id=\"commitrootimpl\" style=\"position:relative;\"><a href=\"#commitrootimpl\" aria-label=\"commitrootimpl permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>commitRootImpl()</h4>\n<p><strong>초기 passive effects 처리</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">flushPassiveEffects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>rootWithPendingPassiveEffects <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">commitRootImpl</code> 함수는 위의 코드로 시작하는데, pending 상태인 passive effect가 있을 경우 반복 호출하면서 이전 렌더링에서 스케쥴링된 effect를 처리한다.</p>\n<p><strong>passive effects 감지 / 스케쥴링</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token operator\">...</span>\n  <span class=\"token comment\">// If there are pending passive effects, schedule a callback to process them.</span>\n  <span class=\"token comment\">// Do this as early as possible, so it is queued before anything else that</span>\n  <span class=\"token comment\">// might get scheduled in the commit phase. (See #16714.)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">.</span>subtreeFlags <span class=\"token operator\">&amp;</span> PassiveMask<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> NoFlags <span class=\"token operator\">||</span>\n    <span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">.</span>flags <span class=\"token operator\">&amp;</span> PassiveMask<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> NoFlags\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>rootDoesHavePassiveEffects<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      rootDoesHavePassiveEffects <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      pendingPassiveEffectsRemainingLanes <span class=\"token operator\">=</span> remainingLanes<span class=\"token punctuation\">;</span>\n      pendingPassiveTransitions <span class=\"token operator\">=</span> transitions<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">scheduleCallback</span><span class=\"token punctuation\">(</span>NormalSchedulerPriority<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">flushPassiveEffects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span>\n</code></pre></div>\n<p>주석에도 적혀있는 것처럼 새로운 passive effects가 있는지 확인하고, 있다면 <code class=\"language-text\">scheduleCallback</code>를 통해 비동기적으로 스케쥴링한다. 이 때 <code class=\"language-text\">NormalSchedulerPriority</code> 를 함께 전달하면서 즉시 실행되지 않고 다른 (우선순위가 높은) 작업 이후 실행되게한다.</p>\n<p><strong>commit 후 Passive Effects 상태 설정</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> rootDidHavePassiveEffects <span class=\"token operator\">=</span> rootDoesHavePassiveEffects<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rootDoesHavePassiveEffects<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// This commit has passive effects. Stash a reference to them. But don't</span>\n  <span class=\"token comment\">// schedule a callback until after flushing layout work.</span>\n  rootDoesHavePassiveEffects <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  rootWithPendingPassiveEffects <span class=\"token operator\">=</span> root<span class=\"token punctuation\">;</span>\n  pendingPassiveEffectsLanes <span class=\"token operator\">=</span> lanes<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// There were no passive effects, so we can immediately release the cache</span>\n  <span class=\"token comment\">// pool for this render.</span>\n  <span class=\"token function\">releaseRootPooledCache</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> remainingLanes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>passive effects를 가지고 있으면 관련 상태를 설정하고, 그렇지 않다면 cache pool을 clear한다.</p>\n<h4 id=\"flushpassiveeffects\" style=\"position:relative;\"><a href=\"#flushpassiveeffects\" aria-label=\"flushpassiveeffects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flushPassiveEffects()</h4>\n<p>그럼 이제 <code class=\"language-text\">commitRootImpl</code>에서 호출하는, useEffect의 callback 함수들을 실행하는 함수 <code class=\"language-text\">flushPassiveEffects</code>를 알아보자.</p>\n<p><strong>실행 조건 확인</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rootWithPendingPassiveEffects <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>최상단에서 pending passive effects가 있는 root가 존재할 때만 실행되도록 하고있다.</p>\n<p><strong>상태 캐싱 &#x26; 초기화</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> rootWithPendingPassiveEffects<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> remainingLanes <span class=\"token operator\">=</span> pendingPassiveEffectsRemainingLanes<span class=\"token punctuation\">;</span>\npendingPassiveEffectsRemainingLanes <span class=\"token operator\">=</span> NoLanes<span class=\"token punctuation\">;</span></code></pre></div>\n<p>현재 root, lane을 캐시하고 남은 lane (<code class=\"language-text\">pendingPassiveEffectsRemainingLanes</code>)을 초기화한다.</p>\n<p><strong>우선 순위 설정</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> renderPriority <span class=\"token operator\">=</span> <span class=\"token function\">lanesToEventPriority</span><span class=\"token punctuation\">(</span>pendingPassiveEffectsLanes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> priority <span class=\"token operator\">=</span> <span class=\"token function\">lowerEventPriority</span><span class=\"token punctuation\">(</span>DefaultEventPriority<span class=\"token punctuation\">,</span> renderPriority<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> prevTransition <span class=\"token operator\">=</span> ReactSharedInternals<span class=\"token punctuation\">.</span><span class=\"token constant\">T</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> previousPriority <span class=\"token operator\">=</span> <span class=\"token function\">getCurrentUpdatePriority</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이후엔 각종 우선순위를 설정하는데, 특히 <code class=\"language-text\">renderPriority</code>, <code class=\"language-text\">priority</code>에서 passive effects의 실행 우선순위를 정한다.</p>\n<p><strong>효과 실행</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setCurrentUpdatePriority</span><span class=\"token punctuation\">(</span>priority<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ReactSharedInternals<span class=\"token punctuation\">.</span><span class=\"token constant\">T</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">flushPassiveEffectsImpl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>전 단계에서 설정한대로 현재 업데이트 우선순위를 설정하고, <code class=\"language-text\">flushPassiveEffectsImpl</code>를 호출해 passive effects를 실행한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setCurrentUpdatePriority</span><span class=\"token punctuation\">(</span>previousPriority<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ReactSharedInternals<span class=\"token punctuation\">.</span><span class=\"token constant\">T</span> <span class=\"token operator\">=</span> prevTransition<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">releaseRootPooledCache</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> remainingLanes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>마지막으로 우선순위, 트랜지션 상태를 원복하고, root의 풀링된 캐시를 해제한다.\n(주석을 보니까 추후 commitPassiveMountEffects로 갈 로직들이 꽤 있는듯.)</p>\n<p>이 프로세스를 보다보니 잘 모르는 개념들이 몇개 나왔다.</p>\n<p>효과 실행 후 <strong>root의 풀링된 캐시를 해제한다</strong>라는 말과 우선순위, 실행을 관리할 때 사용하는 <strong>Lane</strong> 개념이였다. 잘 몰랐던 개념이라 가볍게 정리해보기.</p>\n<ul>\n<li><strong>풀링(pooling)</strong> : 자주 사용되는 객체들을 미리 생성하고, 필요할 때 꺼내쓰는 개념</li>\n<li><strong>해제(release)</strong> : 더이상 사용하지 않는 메모리를 시스템에 반환하는 개념.</li>\n<li><strong>Lane</strong> : Concurrent(동시성) Mode에서 도입된 개념으로, 우선순위를 보다 세밀하게 제어하는 메커니즘. 32비트 정수인 숫자 type으로, 비트 연산이 가능해 OR / AND연산으로 결합할 수 있다.</li>\n</ul>\n<h4 id=\"flushpassiveeffectsimpl\" style=\"position:relative;\"><a href=\"#flushpassiveeffectsimpl\" aria-label=\"flushpassiveeffectsimpl permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flushPassiveEffectsImpl()</h4>\n<p>이제 실제로 효과를 실행하는 로직으로 가보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">//flushPassiveEffectsImpl</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rootWithPendingPassiveEffects <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Cache and clear the transitions flag</span>\n<span class=\"token keyword\">const</span> transitions <span class=\"token operator\">=</span> pendingPassiveTransitions<span class=\"token punctuation\">;</span>\npendingPassiveTransitions <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> rootWithPendingPassiveEffects<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> lanes <span class=\"token operator\">=</span> pendingPassiveEffectsLanes<span class=\"token punctuation\">;</span>\nrootWithPendingPassiveEffects <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\npendingPassiveEffectsLanes <span class=\"token operator\">=</span> NoLanes<span class=\"token punctuation\">;</span></code></pre></div>\n<p>최상단에서 pending passive effects가 있는지 확인하고, 관련 상태들을 초기화하며 시작한다.</p>\n<p><strong>실행 컨텍스트 확인 및 설정</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>executionContext <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>RenderContext <span class=\"token operator\">|</span> CommitContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> NoContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Cannot flush passive effects while already rendering.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">const</span> prevExecutionContext <span class=\"token operator\">=</span> executionContext<span class=\"token punctuation\">;</span>\n  executionContext <span class=\"token operator\">|=</span> CommitContext<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>실행 context를 확인해서 렌더링 중엔 passive effects가 실행되지 않도록 하고, 현재 실행 context를 CommitContext로 설정한다.</p>\n<p><strong>Passive Effects 실행</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token function\">commitPassiveUnmountEffects</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">commitPassiveMountEffects</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> root<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">,</span> lanes<span class=\"token punctuation\">,</span> transitions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>cleanup 함수인 <code class=\"language-text\">commitPassiveUnmountEffects</code>를 먼저 실행하고, 새로운 effect 함수인 <code class=\"language-text\">commitPassiveMountEffects</code>를 실행한다. 이 부분이 실제로 useEffect 콜백이 실행되는 부분이다.\n(이 함수가 useEffect 콜백 최최종 실행인줄 알았으나 여기도 아니였군.. 😇)</p>\n<p><strong>실행 컨텍스트 복원 및 동기 작업 처리</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">executionContext <span class=\"token operator\">=</span> prevExecutionContext<span class=\"token punctuation\">;</span>\n<span class=\"token function\">flushSyncWorkOnAllRoots</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>실행 context를 원래대로 복원하고, 모든 root에 대한 동기 작업을 처리한다.</p>\n<h4 id=\"commitpassiveunmounteffects\" style=\"position:relative;\"><a href=\"#commitpassiveunmounteffects\" aria-label=\"commitpassiveunmounteffects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>commitPassiveUnmountEffects()</h4>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">commitPassiveUnmountEffects</span><span class=\"token punctuation\">(</span>finishedWork<span class=\"token operator\">:</span> Fiber<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>__DEV__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">commitPassiveUnmountOnFiber</span><span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Fiber를 순회하면서 unmount되는 컴포넌트의 cleanup 함수를 실행한다. 이 때 cleanup 로직은 tag에 따라 (FunctionComponent, ForwardRef, SimpleMemoComponent / OffscreenComponent / 그 외) 다른 로직이 적용된다.</p>\n<h4 id=\"commitpassivemountonfiber\" style=\"position:relative;\"><a href=\"#commitpassivemountonfiber\" aria-label=\"commitpassivemountonfiber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>commitPassiveMountOnFiber()</h4>\n<p>commitPassiveUnmountEffects()와 유사하게 Fiber 트리를 순회하면서 새로 mount/update되는 컴포넌트의 useEffect를 실행한다. 이 때 Fiber의 tag(FunctionComponent, ForwardRef, SimpleMemoComponent / HostRoot / OffscreenComponent / 그 외) 에 따라 다른 로직을 실행한다.</p>\n<h2 id=\"왜-useeffect는-데이터-동기화를-위한-메커니즘일까에-답하기\" style=\"position:relative;\"><a href=\"#%EC%99%9C-useeffect%EB%8A%94-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8F%99%EA%B8%B0%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%A9%94%EC%BB%A4%EB%8B%88%EC%A6%98%EC%9D%BC%EA%B9%8C%EC%97%90-%EB%8B%B5%ED%95%98%EA%B8%B0\" aria-label=\"왜 useeffect는 데이터 동기화를 위한 메커니즘일까에 답하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>왜 useEffect는 데이터 동기화를 위한 메커니즘일까?에 답하기</h2>\n<p>앞 분량이 길어졌는데, 이 글의 시작은 useEffect는 데이터 동기화를 위한 메커니즘이라고? 왜? 라는 질문이였다. 지금까지 알아본 것들을 토대로 나름의 답변을 내려보자.</p>\n<h3 id=\"의존성-배열의-변화를-감지해-조건부로-실행\" style=\"position:relative;\"><a href=\"#%EC%9D%98%EC%A1%B4%EC%84%B1-%EB%B0%B0%EC%97%B4%EC%9D%98-%EB%B3%80%ED%99%94%EB%A5%BC-%EA%B0%90%EC%A7%80%ED%95%B4-%EC%A1%B0%EA%B1%B4%EB%B6%80%EB%A1%9C-%EC%8B%A4%ED%96%89\" aria-label=\"의존성 배열의 변화를 감지해 조건부로 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>의존성 배열의 변화를 감지해 조건부로 실행</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ReactFiberHooks.js (updateEffectImpl 함수 내부)</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">areHookInputsEqual</span><span class=\"token punctuation\">(</span>nextDeps<span class=\"token punctuation\">,</span> prevDeps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">pushEffect</span><span class=\"token punctuation\">(</span>hookFlags<span class=\"token punctuation\">,</span> create<span class=\"token punctuation\">,</span> destroy<span class=\"token punctuation\">,</span> nextDeps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://dev-bomdong.github.io/react-useEffect/#effect-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EC%8A%A4%EC%BC%80%EC%A5%B4%EB%A7%81\">effect 생성 및 스케쥴링</a>에서 살펴본 <code class=\"language-text\">updateEffectImpl</code> 함수를 떠올려보면, <code class=\"language-text\">areHookInputsEqual</code>함수를 통해 의존성 배열의 변화를 감지하고(이전과 일치하는지 검증)하고 effect의 재실행 여부를 결정했다. 의존성 배열이란 데이터의 변경에 따라 조건부로 실행된다.</p>\n<h3 id=\"렌더링과-effect의-분리-및-비동기적-실행\" style=\"position:relative;\"><a href=\"#%EB%A0%8C%EB%8D%94%EB%A7%81%EA%B3%BC-effect%EC%9D%98-%EB%B6%84%EB%A6%AC-%EB%B0%8F-%EB%B9%84%EB%8F%99%EA%B8%B0%EC%A0%81-%EC%8B%A4%ED%96%89\" aria-label=\"렌더링과 effect의 분리 및 비동기적 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>렌더링과 effect의 분리 및 비동기적 실행</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">.</span>subtreeFlags <span class=\"token operator\">&amp;</span> PassiveMask<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> NoFlags <span class=\"token operator\">||</span>\n  <span class=\"token punctuation\">(</span>finishedWork<span class=\"token punctuation\">.</span>flags <span class=\"token operator\">&amp;</span> PassiveMask<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> NoFlags\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">scheduleCallback</span><span class=\"token punctuation\">(</span>NormalSchedulerPriority<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">flushPassiveEffects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://dev-bomdong.github.io/react-useEffect/#commitrootimpl\">commitRootImpl</a> 함수에서 effect가 실행되는 코드를 다시 가져와봤다.\n렌더링은 동기적으로 이루어지지만, effect의 실행(<code class=\"language-text\">flushPassiveEffects</code>)은 별도로 스케줄링 (<code class=\"language-text\">scheduleCallback</code>)된다. 따라서 UI 업데이트와 데이터 동기화 작업이 서로를 방해하지 않는다.</p>\n<p><code class=\"language-text\">scheduleCallback</code>은 React의 스케쥴러를 통해 작업을 비동기적으로 + 우선순위에 기반해 + 중단 가능하게 실행한다. 이 특징은 Concurrent mode에서 더 중요해지는데 화면이 갱신될 때 UI 먼저 즉시 반영하고, useEffect 내부에서 데이터를 불러올 경우 비동기적으로 실행할 수 있다.</p>\n<h3 id=\"cleanup-이후-새로운-동기화\" style=\"position:relative;\"><a href=\"#cleanup-%EC%9D%B4%ED%9B%84-%EC%83%88%EB%A1%9C%EC%9A%B4-%EB%8F%99%EA%B8%B0%ED%99%94\" aria-label=\"cleanup 이후 새로운 동기화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>cleanUp 이후 새로운 동기화</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ReactFiberWorkLoop.js</span>\n<span class=\"token function\">commitPassiveUnmountEffects</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">commitPassiveMountEffects</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> root<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">,</span> lanes<span class=\"token punctuation\">,</span> transitions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"https://dev-bomdong.github.io/react-useEffect/#flushpassiveeffectsimpl\">flushPassiveEffectsImpl</a> 함수 내부를 보면\n이전 effect의 cleanUp 함수(<code class=\"language-text\">commitPassiveUnmountEffects</code>)를 먼저 실행하고, 그 다음 새로운 effect를 실행한다. 이전 상태와의 동기화를 해제하고, 그 다음 새로운 상태와 동기화하는 과정이라 할 수 있다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마치며</h2>\n<p>사실 React 코드를 들여다본다고 해서 당장 다음날부터 개발 실력이 수직상승하는 건 아닐테지만 내가 잘 모르는 어떤 대단한 방법으로 알아서 처리되겠지라고 생각했던 것들의 실체와 가까워지며 매일 사용하는 React에 대한, 또 내가 코드를 쳐서 무언가를 만들어내는 작업의 해상도를 올리는 작업이 될 수 있을거라 생각했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeElEQVQ4y52TTXKcMBCFuf8FfIVUZZuq7HKAVDa2ZzxjBBqEAEnoBwkEQghwChjbWWSRyrfo0ua1Wq+fIjfND1++/TyBaRxN267r+raz3nn7KyGEZVki1bmHr99//HoZhkE2OoT57R9Y9q7Ruq5SytG5ZVn6vldKWWs7a1lda2201tbavh+kVG6ns10I4WixiTnnGBdSygyhFN5U00ipqooUZUkIbbTmXBBKx9EPw9A0jTFmHP0mXpYlQwgXRdt1NecozwmhhNKqIpRRXBRCCMa2KRirGWP9xtD3wyae51kqJaWklNV1nSFECKGMwVtWliVCeVmWjNVt23VdJ3eKshRC3sV1XbdtSygtijIGoKyqrRHnUkqllDambdu+77uus9YaY4QQ3vv3m6V0zhljOOcxABgXZodQakzLWN00WiqltSaECimX9wVGm+8788Yyjn6apnVd53mepunPuizLNE0fVt/F/010hGgYBsZY0zRCCM65EKJpGs75UZVShBBrrdZaSmmtPSIYfcQtz3MIIULo9fU1TdM4ji+XS57n5/M5z/Pb7YYxjuOYc/4ZEueclJJzDgB4fn6+XC6n0+np6elQQgjjOIYQZlmWJAnYOaZzzkUhBGNMt2OtHcfR7hQ7CKGqqvq+DzvTNBljjoV57z/HrqpKa00pLbcMiDRNAQAQQgDAPQiEHO+f5/vnibz3GGNKabqDEHp5ecEYAwDO53OSJNfr9fHxMcuyNE0xxhDCoiiqqtq+5DzPbdsqpTDG1+u1LEsI4dEIAHCYhxBKkiRN0zzPkyQxxgzD8On2uq4hBOfc9E4IwXvvnPPehxDGcTzOR4SOsX8D517zOj1v1xcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"공부에_대한_새로운_시선_이미지.png\"\n        title=\"공부에_대한_새로운_시선_이미지.png\"\n        src=\"/static/bbd827ce08feb038f2a25cbd323f1398/37523/%EA%B3%B5%EB%B6%80%EC%97%90_%EB%8C%80%ED%95%9C_%EC%83%88%EB%A1%9C%EC%9A%B4_%EC%8B%9C%EC%84%A0_%EC%9D%B4%EB%AF%B8%EC%A7%80.png\"\n        srcset=\"/static/bbd827ce08feb038f2a25cbd323f1398/e9ff0/%EA%B3%B5%EB%B6%80%EC%97%90_%EB%8C%80%ED%95%9C_%EC%83%88%EB%A1%9C%EC%9A%B4_%EC%8B%9C%EC%84%A0_%EC%9D%B4%EB%AF%B8%EC%A7%80.png 180w,\n/static/bbd827ce08feb038f2a25cbd323f1398/f21e7/%EA%B3%B5%EB%B6%80%EC%97%90_%EB%8C%80%ED%95%9C_%EC%83%88%EB%A1%9C%EC%9A%B4_%EC%8B%9C%EC%84%A0_%EC%9D%B4%EB%AF%B8%EC%A7%80.png 360w,\n/static/bbd827ce08feb038f2a25cbd323f1398/37523/%EA%B3%B5%EB%B6%80%EC%97%90_%EB%8C%80%ED%95%9C_%EC%83%88%EB%A1%9C%EC%9A%B4_%EC%8B%9C%EC%84%A0_%EC%9D%B4%EB%AF%B8%EC%A7%80.png 720w,\n/static/bbd827ce08feb038f2a25cbd323f1398/302a4/%EA%B3%B5%EB%B6%80%EC%97%90_%EB%8C%80%ED%95%9C_%EC%83%88%EB%A1%9C%EC%9A%B4_%EC%8B%9C%EC%84%A0_%EC%9D%B4%EB%AF%B8%EC%A7%80.png 1080w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>예전엔 원리보단 어떻게든 빨리 활용해내서 일정안에 주어진 미션을 해내야한다..에 집중했고 그러다보니 모든 것들을 수박 겉핥기식으로 알고있다는 무력감이 있었다. (이 감정들을 그냥 “비전공자 컴플렉스”라는 단어로 퉁치고 회피했는데 이젠 알 것 같다. 중요한건 전공이 아니라 저 무력감이였다는 것을)</p>\n<p><strong>내가 이해할 수 없는 코드로 짜여져 있을것 같고 막연해보였던 것들을 사소한 수준부터 이해의 영역으로 끌어오는 순간</strong>이 (예를 들어 effect도 결국은 객체구나, useEffect와 useLayoutEffect는 결국 숫자 타입인 비트 플래그를 통해서 구분하는 거였구나 등) 효능감과 향상심을 천천히 야금야금 채워준 즐거운 경험이였다. 🍀 다음엔 어떤 부분을 채워볼까</p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://ko.react.dev/learn/lifecycle-of-reactive-effects\">https://ko.react.dev/learn/lifecycle-of-reactive-effects</a></li>\n<li><a href=\"https://ko.react.dev/learn/synchronizing-with-effects\">https://ko.react.dev/learn/synchronizing-with-effects</a></li>\n<li><a href=\"https://d2.naver.com/helloworld/2690975\">https://d2.naver.com/helloworld/2690975</a></li>\n<li><a href=\"https://jser.dev/2023-07-08-how-does-useeffect-work\">https://jser.dev/2023-07-08-how-does-useeffect-work</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\">들어가며</a></p>\n</li>\n<li>\n<p><a href=\"#useeffect%EC%9D%98-%EC%8B%A4%ED%96%89-%EA%B3%BC%EC%A0%95\">useEffect의 실행 과정</a></p>\n<ul>\n<li>\n<p><a href=\"#dispatcheruseeffect%EC%99%80-%EB%A0%8C%EB%8D%94%EB%A7%81-%EB%8B%A8%EA%B3%84%EB%B3%84-%EC%B2%98%EB%A6%AC\">dispatcher.useEffect와 렌더링 단계별 처리</a></p>\n</li>\n<li>\n<p><a href=\"#effect-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EC%8A%A4%EC%BC%80%EC%A5%B4%EB%A7%81\">effect 생성 및 스케쥴링</a></p>\n<ul>\n<li><a href=\"#pusheffect\">pushEffect()</a></li>\n<li><a href=\"#effect-%EA%B0%9D%EC%B2%B4%EC%9D%98-tag\">effect 객체의 tag</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#commit-phase%EC%97%90%EC%84%9C%EC%9D%98-useeffect\"><strong>commit phase에서의 useEffect</strong></a></p>\n<ul>\n<li><a href=\"#commitrootimpl\">commitRootImpl()</a></li>\n<li><a href=\"#flushpassiveeffects\">flushPassiveEffects()</a></li>\n<li><a href=\"#flushpassiveeffectsimpl\">flushPassiveEffectsImpl()</a></li>\n<li><a href=\"#commitpassiveunmounteffects\">commitPassiveUnmountEffects()</a></li>\n<li><a href=\"#commitpassivemountonfiber\">commitPassiveMountOnFiber()</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%99%9C-useeffect%EB%8A%94-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8F%99%EA%B8%B0%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%A9%94%EC%BB%A4%EB%8B%88%EC%A6%98%EC%9D%BC%EA%B9%8C%EC%97%90-%EB%8B%B5%ED%95%98%EA%B8%B0\">왜 useEffect는 데이터 동기화를 위한 메커니즘일까?에 답하기</a></p>\n<ul>\n<li><a href=\"#%EC%9D%98%EC%A1%B4%EC%84%B1-%EB%B0%B0%EC%97%B4%EC%9D%98-%EB%B3%80%ED%99%94%EB%A5%BC-%EA%B0%90%EC%A7%80%ED%95%B4-%EC%A1%B0%EA%B1%B4%EB%B6%80%EB%A1%9C-%EC%8B%A4%ED%96%89\">의존성 배열의 변화를 감지해 조건부로 실행</a></li>\n<li><a href=\"#%EB%A0%8C%EB%8D%94%EB%A7%81%EA%B3%BC-effect%EC%9D%98-%EB%B6%84%EB%A6%AC-%EB%B0%8F-%EB%B9%84%EB%8F%99%EA%B8%B0%EC%A0%81-%EC%8B%A4%ED%96%89\">렌더링과 effect의 분리 및 비동기적 실행</a></li>\n<li><a href=\"#cleanup-%EC%9D%B4%ED%9B%84-%EC%83%88%EB%A1%9C%EC%9A%B4-%EB%8F%99%EA%B8%B0%ED%99%94\">cleanUp 이후 새로운 동기화</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">마치며</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2024","title":"데이터 동기화 메커니즘으로서의 useEffect 탐구하기","categories":"React","author":"Bomdong","emoji":"🔁"},"fields":{"slug":"/react-useEffect/"}},"site":{"siteMetadata":{"siteUrl":"https://dev-bomdong.github.io","comments":{"utterances":{"repo":"dev-bomdong/dev-bomdong.github.io"}}}}},"pageContext":{"slug":"/react-strategy-pattern/","nextSlug":"/react-hoc-pattern/","prevSlug":"/react-useEffect/"}},"staticQueryHashes":["1073350324","2009502679","2938748437"],"slicesMap":{}}